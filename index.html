<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sports Ticker - The Bench Warmers</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: transparent;
            font-family: 'Arial', sans-serif;
            overflow: hidden;
            height: 100vh;
        }

        .ticker-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: linear-gradient(90deg, #000814 0%, #001d3d 50%, #000814 100%);
            border-bottom: 3px solid #ffd60a;
            box-shadow: 0 5px 20px rgba(255, 214, 10, 0.3);
            height: 100px;
            overflow: hidden;
            z-index: 1000;
        }

        .ticker-header {
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            background: #000000;
            color: #ffffff;
            display: flex;
            align-items: center;
            padding: 0 25px;
            font-weight: bold;
            font-size: 18px;
            z-index: 1001;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.5);
            min-width: 250px;
        }

        .live-sports-text {
            color: #ff0000;
            font-weight: bold;
        }

        .brand-text {
            color: #ffffff;
            font-weight: bold;
        }

        .ticker-content {
            position: absolute;
            left: 250px;
            top: 0;
            height: 100%;
            display: flex;
            align-items: center;
            animation: scroll 75s linear infinite;
            white-space: nowrap;
        }

        @keyframes scroll {
            0% {
                transform: translateX(100vw);
            }
            100% {
                transform: translateX(-100%);
            }
        }

        .ticker-item {
            display: inline-flex;
            align-items: center;
            margin-right: 50px;
            color: #ffffff;
            font-size: 20px;
            font-weight: 500;
        }

        .sport-badge {
            background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
            color: white;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 14px;
            font-weight: bold;
            margin-right: 15px;
            text-transform: uppercase;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }

        .sport-badge.mlb {
            background: linear-gradient(135deg, #132448 0%, #bf0d3e 100%);
        }

        .sport-badge.nba {
            background: linear-gradient(135deg, #c9082a 0%, #17408b 100%);
        }

        .sport-badge.nfl {
            background: linear-gradient(135deg, #013369 0%, #d50a0a 100%);
        }

        .sport-badge.mls {
            background: linear-gradient(135deg, #005DAA 0%, #FF6900 100%);
        }

        .sport-badge.ncaa {
            background: linear-gradient(135deg, #ff8500 0%, #232d4b 100%);
        }

        .score-display {
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 16px;
            border-radius: 18px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .team {
            font-weight: bold;
            color: #ffd60a;
        }

        .score {
            color: #ffffff;
            font-weight: bold;
        }

        .vs {
            color: #a0a0a0;
            font-size: 12px;
        }

        .time-status {
            color: #fbbf24;
            font-size: 16px;
            margin-left: 8px;
        }

        .odds {
            color: #22c55e;
            font-weight: bold;
            margin-left: 8px;
        }

        .news-item {
            color: #ffffff;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .breaking {
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
            color: white;
            padding: 4px 10px;
            border-radius: 10px;
            font-size: 12px;
            font-weight: bold;
            animation: breakingPulse 1.5s infinite;
        }

        @keyframes breakingPulse {
            0%, 100% { 
                opacity: 1; 
                transform: scale(1);
            }
            50% { 
                opacity: 0.8; 
                transform: scale(1.05);
            }
        }

        .separator {
            color: #ffd60a;
            margin: 0 12px;
            font-size: 22px;
        }

        .loading {
            color: #fbbf24;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="ticker-container">
        <div class="ticker-header">
            <div><span class="live-sports-text">LIVE SPORTS</span> â€¢ <span class="brand-text">The Bench Warmers</span></div>
        </div>
        <div class="ticker-content" id="tickerContent">
            <div class="ticker-item">
                <div class="news-item loading">
                    <span>Loading ESPN API data...</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        class SportsTicker {
            constructor() {
                this.tickerContent = document.getElementById('tickerContent');
                this.init();
            }

            init() {
                console.log('Starting TheSportsDB API ticker...');
                this.loadSportsDBData();
                // Update every 5 minutes
                setInterval(() => this.loadSportsDBData(), 300000);
            }

            async fetchSportsDBData(league) {
                try {
                    // Your TheSportsDB Premium API Key
                    const apiKey = '813745';
                    const today = new Date().toISOString().split('T')[0]; // YYYY-MM-DD format
                    
                    // Get today's events for the league
                    const apiUrl = `https://www.thesportsdb.com/api/v1/json/${apiKey}/eventsday.php?d=${today}&l=${league}`;
                    console.log(`Fetching TheSportsDB: ${apiUrl}`);
                    
                    const response = await fetch(apiUrl);
                    const data = await response.json();
                    return data;
                } catch (error) {
                    console.error(`TheSportsDB API Error (${league}):`, error);
                    return null;
                }
            }

            async fetchSportsDBNews() {
                try {
                    const apiKey = '813745';
                    // Get latest sports news
                    const apiUrl = `https://www.thesportsdb.com/api/v1/json/${apiKey}/latestnews.php`;
                    console.log(`Fetching TheSportsDB News: ${apiUrl}`);
                    
                    const response = await fetch(apiUrl);
                    const data = await response.json();
                    return data;
                } catch (error) {
                    console.error(`TheSportsDB News API Error:`, error);
                    return null;
                }
            }

            async fetchLiveScores() {
                try {
                    // Use V2 API for live scores (no key needed for this endpoint)
                    const apiUrl = `https://www.thesportsdb.com/api/v2/json/livescore/soccer`;
                    console.log(`Fetching Live MLS Scores: ${apiUrl}`);
                    
                    const response = await fetch(apiUrl);
                    const data = await response.json();
                    return data;
                } catch (error) {
                    console.error(`TheSportsDB Live Scores Error:`, error);
                    return null;
                }
            }

            parseSportsDBEvents(sportsData, sportName, leagueId) {
                if (!sportsData || !sportsData.events) return [];
                
                const games = [];
                const today = new Date().toDateString();
                
                sportsData.events.forEach(event => {
                    const gameDate = new Date(event.dateEvent);
                    
                    // Only include today's games
                    if (gameDate.toDateString() === today) {
                        // Parse team names/abbreviations
                        const homeTeam = event.strHomeTeam;
                        const awayTeam = event.strAwayTeam;
                        
                        // Get scores
                        const homeScore = event.intHomeScore || '0';
                        const awayScore = event.intAwayScore || '0';
                        
                        // Determine game status
                        let gameStatus = 'Scheduled';
                        let gameType = 'upcoming';
                        
                        if (event.strStatus === 'Match Finished') {
                            gameStatus = 'FINAL';
                            gameType = 'score';
                        } else if (event.strStatus === 'In Play') {
                            gameStatus = event.strProgress || 'LIVE';
                            gameType = 'score';
                        } else if (event.strTime) {
                            // Format start time
                            gameStatus = event.strTime + ' ET';
                        }
                        
                        // Get sport emoji and abbreviations
                        let sportEmoji = '';
                        let team1Abbr = '';
                        let team2Abbr = '';
                        
                        switch(sportName) {
                            case 'MLB': 
                                sportEmoji = 'âš¾'; 
                                team1Abbr = this.getMLBTeamAbbr(awayTeam);
                                team2Abbr = this.getMLBTeamAbbr(homeTeam);
                                break;
                            case 'MLS': 
                                sportEmoji = 'âš½'; 
                                team1Abbr = this.getMLSTeamAbbr(awayTeam);
                                team2Abbr = this.getMLSTeamAbbr(homeTeam);
                                break;
                            case 'NBA': 
                                sportEmoji = 'ðŸ€';
                                team1Abbr = this.getNBATeamAbbr(awayTeam);
                                team2Abbr = this.getNBATeamAbbr(homeTeam);
                                break;
                            case 'NFL': 
                                sportEmoji = 'ðŸˆ';
                                team1Abbr = this.getNFLTeamAbbr(awayTeam);
                                team2Abbr = this.getNFLTeamAbbr(homeTeam);
                                break;
                            default: 
                                sportEmoji = 'ðŸ†';
                                team1Abbr = awayTeam?.substring(0, 3).toUpperCase() || 'TBD';
                                team2Abbr = homeTeam?.substring(0, 3).toUpperCase() || 'TBD';
                                break;
                        }
                        
                        const gameData = {
                            type: gameType,
                            sport: sportName,
                            emoji: sportEmoji,
                            team1: team1Abbr,
                            team2: team2Abbr,
                            score1: parseInt(awayScore),
                            score2: parseInt(homeScore),
                            status: gameStatus
                        };
                        
                        games.push(gameData);
                    }
                });
                
                return games;
            }

            // Helper functions for team abbreviations
            getMLBTeamAbbr(teamName) {
                const mlbTeams = {
                    'Boston Red Sox': 'BOS', 'New York Yankees': 'NYY', 'Toronto Blue Jays': 'TOR',
                    'Baltimore Orioles': 'BAL', 'Tampa Bay Rays': 'TB', 'Houston Astros': 'HOU',
                    'Oakland Athletics': 'OAK', 'Seattle Mariners': 'SEA', 'Los Angeles Angels': 'LAA',
                    'Texas Rangers': 'TEX', 'Kansas City Royals': 'KC', 'Minnesota Twins': 'MIN',
                    'Cleveland Guardians': 'CLE', 'Detroit Tigers': 'DET', 'Chicago White Sox': 'CWS',
                    'Los Angeles Dodgers': 'LAD', 'San Diego Padres': 'SD', 'San Francisco Giants': 'SF',
                    'Colorado Rockies': 'COL', 'Arizona Diamondbacks': 'ARI', 'Atlanta Braves': 'ATL',
                    'Miami Marlins': 'MIA', 'New York Mets': 'NYM', 'Philadelphia Phillies': 'PHI',
                    'Washington Nationals': 'WSH', 'Milwaukee Brewers': 'MIL', 'Chicago Cubs': 'CHC',
                    'Cincinnati Reds': 'CIN', 'Pittsburgh Pirates': 'PIT', 'St. Louis Cardinals': 'STL'
                };
                return mlbTeams[teamName] || teamName?.substring(0, 3).toUpperCase() || 'TBD';
            }

            getMLSTeamAbbr(teamName) {
                const mlsTeams = {
                    'Los Angeles FC': 'LAFC', 'LA Galaxy': 'LAG', 'Seattle Sounders': 'SEA',
                    'Portland Timbers': 'POR', 'Atlanta United': 'ATL', 'Inter Miami': 'MIA',
                    'New York City FC': 'NYC', 'New York Red Bulls': 'NYRB', 'Philadelphia Union': 'PHI',
                    'Toronto FC': 'TOR', 'Montreal Impact': 'MTL', 'Columbus Crew': 'CLB',
                    'Chicago Fire': 'CHI', 'FC Cincinnati': 'CIN', 'Nashville SC': 'NSH'
                };
                return mlsTeams[teamName] || teamName?.substring(0, 3).toUpperCase() || 'TBD';
            }

            getNBATeamAbbr(teamName) {
                const nbaTeams = {
                    'Los Angeles Lakers': 'LAL', 'Golden State Warriors': 'GSW', 'Boston Celtics': 'BOS',
                    'Miami Heat': 'MIA', 'Chicago Bulls': 'CHI', 'New York Knicks': 'NYK'
                };
                return nbaTeams[teamName] || teamName?.substring(0, 3).toUpperCase() || 'TBD';
            }

            getNFLTeamAbbr(teamName) {
                const nflTeams = {
                    'Kansas City Chiefs': 'KC', 'Buffalo Bills': 'BUF', 'Dallas Cowboys': 'DAL',
                    'Philadelphia Eagles': 'PHI', 'Green Bay Packers': 'GB', 'New England Patriots': 'NE'
                };
                return nflTeams[teamName] || teamName?.substring(0, 3).toUpperCase() || 'TBD';
            }

            async loadSportsDBData() {
                console.log('Loading TheSportsDB data with API Key 813745...');
                let allContent = [];
                
                try {
                    // TheSportsDB League IDs for major US sports
                    const leagues = [
                        { id: '4424', name: 'MLB', sport: 'MLB' },      // Major League Baseball
                        { id: '4346', name: 'MLS', sport: 'MLS' }       // Major League Soccer (current season)
                    ];
                    
                    // Load data for current season leagues only
                    for (const league of leagues) {
                        const leagueData = await this.fetchSportsDBData(league.id);
                        if (leagueData && leagueData.events) {
                            const games = this.parseSportsDBEvents(leagueData, league.sport, league.id);
                            allContent.push(...games);
                            console.log(`Loaded ${games.length} ${league.sport} games from TheSportsDB`);
                        } else {
                            console.log(`No games found for ${league.sport} today`);
                        }
                    }
                    
                    // Get live MLS scores using V2 API
                    const liveScores = await this.fetchLiveScores();
                    if (liveScores && liveScores.events) {
                        console.log(`Found ${liveScores.events.length} live soccer matches`);
                        // Parse live scores if they're MLS games
                        liveScores.events.forEach(event => {
                            if (event.strLeague && event.strLeague.includes('MLS')) {
                                allContent.push({
                                    type: 'score',
                                    sport: 'MLS',
                                    emoji: 'âš½',
                                    team1: event.strHomeTeam?.substring(0, 3).toUpperCase() || 'HOME',
                                    team2: event.strAwayTeam?.substring(0, 3).toUpperCase() || 'AWAY',
                                    score1: parseInt(event.intHomeScore) || 0,
                                    score2: parseInt(event.intAwayScore) || 0,
                                    status: event.strProgress || 'LIVE'
                                });
                            }
                        });
                    }
                    
                    // Load sports news
                    const newsData = await this.fetchSportsDBNews();
                    if (newsData && newsData.articles) {
                        const newsItems = newsData.articles.slice(0, 3).map(article => ({
                            type: 'news',
                            content: article.strHeadline || article.strNews || 'Sports news update',
                            breaking: false
                        }));
                        allContent.push(...newsItems);
                        console.log(`Loaded ${newsItems.length} news stories from TheSportsDB`);
                    }
                    
                    // If no real content, add placeholder
                    if (allContent.length === 0) {
                        allContent.push({
                            type: 'news',
                            content: 'Checking for live games and breaking sports news...'
                        });
                    }
                    
                    // Add branded content
                    allContent.push({
                        type: 'news',
                        content: 'Follow The Bench Warmers for live sports betting analysis'
                    });
                    
                } catch (error) {
                    console.error('TheSportsDB loading error:', error);
                    allContent = [
                        {
                            type: 'news',
                            content: 'Loading live sports data and breaking news...'
                        },
                        {
                            type: 'news',
                            content: 'Follow The Bench Warmers for live sports updates'
                        }
                    ];
                }
                
                console.log(`Total content loaded: ${allContent.length} items`);
                this.renderContent(allContent);
            }

            renderContent(data) {
                const contentHtml = data.map(item => {
                    if (item.type === 'score') {
                        return `
                            <div class="ticker-item">
                                <span class="sport-badge ${item.sport.toLowerCase()}">${item.emoji} ${item.sport}</span>
                                <div class="score-display">
                                    <span class="team">${item.team1}</span>
                                    <span class="score">${item.score1}</span>
                                    <span class="vs">vs</span>
                                    <span class="team">${item.team2}</span>
                                    <span class="score">${item.score2}</span>
                                    <span class="time-status">${item.status}</span>
                                </div>
                            </div>
                        `;
                    } else if (item.type === 'upcoming') {
                        return `
                            <div class="ticker-item">
                                <span class="sport-badge ${item.sport.toLowerCase()}">${item.emoji} ${item.sport}</span>
                                <div class="score-display">
                                    <span class="team">${item.team1}</span>
                                    <span class="vs">@</span>
                                    <span class="team">${item.team2}</span>
                                    <span class="time-status">${item.status}</span>
                                </div>
                            </div>
                        `;
                    } else if (item.type === 'news') {
                        return `
                            <div class="ticker-item">
                                <div class="news-item">
                                    <span>${item.content}</span>
                                </div>
                            </div>
                        `;
                    }
                    return '';
                }).join('<span class="separator">â€¢</span>');
                
                this.tickerContent.innerHTML = contentHtml;
                console.log('Content rendered to ticker');
            }
        }

        // Start the ticker
        document.addEventListener('DOMContentLoaded', () => {
            new SportsTicker();
        });
    </script>
</body>
</html>
